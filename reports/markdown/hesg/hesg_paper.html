<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Will King">
<meta name="author" content="Tomos Robinson">
<meta name="author" content="Angela Bate">
<meta name="author" content="Laura Ternent">
<meta name="keywords" content="template, demo">

<title>Development of a value-based scoring system for the WAItE using the OPUF in a sample of adults</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="hesg_paper_files/libs/clipboard/clipboard.min.js"></script>
<script src="hesg_paper_files/libs/quarto-html/quarto.js"></script>
<script src="hesg_paper_files/libs/quarto-html/popper.min.js"></script>
<script src="hesg_paper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hesg_paper_files/libs/quarto-html/anchor.min.js"></script>
<link href="hesg_paper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hesg_paper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hesg_paper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hesg_paper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hesg_paper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Development of a value-based scoring system for the WAItE using the OPUF in a sample of adults</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Will King <a href="mailto:w.king2@newcastle.ac.uk" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0000-0000-0000" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Newcastle University
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Tomos Robinson </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Newcastle University
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Angela Bate </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            
          </p>
        <p class="affiliation">
            Northumbria University
          </p>
        <p class="affiliation">
            
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Laura Ternent </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Newcastle University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>Ipsum nostra facilisis sapien nullam. Facilisi himenaeos pharetra ultricies scelerisque non fusce quisque aliquam netus tellus. Dictum tellus et sociis quisque ornare ad a natoque magna blandit. Tortor duis aptent cursus lacus inceptos tristique magnis dictumst. Taciti varius nascetur aliquet hac ornare vitae ultricies. Rhoncus primis purus morbi aliquet quam cubilia nullam malesuada ridiculus.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>template, demo</p>
  </div>
</div>

</header>


<section id="sec-introduction" class="level1">
<h1>Introduction</h1>
<p>This chapter presents the introduction, methods, results and discussion from an empirical study developing a utility value set for the WAItE using online personal utility functions (OPUF) with a representative sample of UK adults.</p>
<section id="compositional-preference-elicitation-methods" class="level2">
<h2 class="anchored" data-anchor-id="compositional-preference-elicitation-methods">Compositional preference elicitation methods</h2>
<p>Preference elicitation methods generally speaking, fall into two categories: compositional and decompositional <span class="citation" data-cites="Keeney1979DecisionsTrade-Offs Marsh2016MultipleForce Belton2002MultipleAnalysis">(<a href="#ref-Keeney1979DecisionsTrade-Offs" role="doc-biblioref">Keeney and Raiffa 1979</a>; <a href="#ref-Marsh2016MultipleForce" role="doc-biblioref">Marsh et al. 2016</a>; <a href="#ref-Belton2002MultipleAnalysis" role="doc-biblioref">Belton and Stewart 2002</a>)</span>. That is, methods like DCE, BWS and TTO elicit preference orderings from individuals for an entire health state (composed of a combination of domains and levels) and then responses are decomposed to identify marginal contributions of each domain and level in each health state. Models like multinomial logit, mixed logit and latent class are frequently used to decompose responses to decompositional preference elicitation tasks <span class="citation" data-cites="Hauber2016StatisticalForce">(<a href="#ref-Hauber2016StatisticalForce" role="doc-biblioref">Hauber et al. 2016</a>)</span>. Coefficients estimated in these models form the basis of dis/utility values for each domain and level in a descriptive system.</p>
<p>Conversely, compositional methods seek to identify preferences for each domain weighting and level rating individually for the number of domains and levels in a given descriptive system. Therefore, statistical models to elicit coefficients for each individual domain and level are not required and responses to each domain weighting and level rating are combined (in addition to an anchoring factor) to yield dis/utility values for each domain and level in the descriptive system. Compositional approaches can take many forms from simple VAS scores to using semantic categories and ranking methods <span class="citation" data-cites="BanaECosta1999TheApplication Danner2011IntegratingPreferences Oliveira2018ValuingStates">(<a href="#ref-BanaECosta1999TheApplication" role="doc-biblioref">Bana E Costa and Vansnick 1999</a>; <a href="#ref-Danner2011IntegratingPreferences" role="doc-biblioref">Danner et al. 2011</a>; <a href="#ref-Oliveira2018ValuingStates" role="doc-biblioref">Oliveira et al. 2018</a>)</span>. These approaches have been used successfully in multi-criteria decision analysis (MCDA), but have been used less extensively in the preference elicitation space. Since the development of the OPUF, compositional approaches to elicit preferences have become more commonplace and a number of countries are using the OPUF to elicit value sets specific to their population <span class="citation" data-cites="Brodszky2023PCR108States">(<a href="#ref-Brodszky2023PCR108States" role="doc-biblioref">Brodszky et al. 2023</a>)</span>.</p>
</section>
<section id="from-puf-to-opuf" class="level2">
<h2 class="anchored" data-anchor-id="from-puf-to-opuf">From PUF to OPUF</h2>
<p>Personal utility functions were first used in the context of preference elicitation by Devlin et al.&nbsp;(2019) <span class="citation" data-cites="Devlin2019AFunctions">(<a href="#ref-Devlin2019AFunctions" role="doc-biblioref">Devlin et al. 2019</a>)</span> to estimate the feasibility for using this approach to estimate a value set for the EQ5D-5L. Since the feasibility for the underlying PUF methods were established, the approach has been expanded by Schneider and colleagues and converted into an online personal utility functions (OPUF) survey built initially using RShiny <span class="citation" data-cites="Schneider2022TheStates">(<a href="#ref-Schneider2022TheStates" role="doc-biblioref">P. P. Schneider et al. 2022</a>)</span> and subsequently using Javascript (available <a href="https://eq5d5l.me">here</a>). Since the development of the OPUF, a number of descriptive systems and different research teams have begun utilising this method to elicit value sets <span class="citation" data-cites="Bray2024DevelopmentImpairment Brodszky2023PCR108States">(<a href="#ref-Bray2024DevelopmentImpairment" role="doc-biblioref">Bray, Tudor Edwards, and Schneider 2024</a>; <a href="#ref-Brodszky2023PCR108States" role="doc-biblioref">Brodszky et al. 2023</a>)</span>.</p>
</section>
<section id="an-overview-of-the-opuf-structure" class="level2">
<h2 class="anchored" data-anchor-id="an-overview-of-the-opuf-structure">An overview of the OPUF structure</h2>
<ol type="1">
<li>Domain weighting: This section is composed of two parts. First, domain ranking is completed where participants identify their most important domain. Second, respondents complete the domain weighting (swing weighting) where the relative importance of other domains is ascertained using their most important domain as a reference point. These questions are presented in Figure <span class="math inline">\(\ref{fig:domain weighting}\)</span>.</li>
<li>Level ratings: This element of the OPUF has varied across different iterations of the survey. Schnieder et al.&nbsp;(2022) <span class="citation" data-cites="Schneider2022TheStates">(<a href="#ref-Schneider2022TheStates" role="doc-biblioref">P. P. Schneider et al. 2022</a>)</span> asked participants to rank the levels within the descriptive system generally (i.e.&nbsp;for any given domain), while other iterations have administered separate level rating questions for each domain in the descriptive system <span class="citation" data-cites="Bray2024DevelopmentImpairment">(<a href="#ref-Bray2024DevelopmentImpairment" role="doc-biblioref">Bray, Tudor Edwards, and Schneider 2024</a>)</span>. Selection of method requires a trade-off between participant burden and sensitivity of level ratings to each domain. Figure <span class="math inline">\(\ref{fig:level rating}\)</span> presents the level rating question for the pain/discomfort domain of the EQ5D-5L.</li>
<li>Anchoring factor: A task is required to rescale the latent coefficients estimated via combining level ratings and domain weights onto the QALY scale. Participants are presented with a binary choice between the PITS state (or another state) of a given descriptive system and “being dead”. If the PITS state is chosen, participants are asked to rank the PITS state on a VAS from 1 (full health) to 0 (dead). If “being dead” is chosen, participants are asked to rank “being dead” on a VAS from 1 (full health) to 0 (PITS state). Responses to these respective questions provide the anchoring factor. Anchoring questions, such that PITS is preferred to dead, are presented in Figure <span class="math inline">\(\ref{fig:anchoring factor}\)</span>.</li>
</ol>
</section>
<section id="sec-OPUF_methods" class="level2">
<h2 class="anchored" data-anchor-id="sec-OPUF_methods">OPUF logic and mathematics</h2>
<p>This section presents the logic and underlying mathematics required to convert the raw OPUF responses from one person into an anchored value set for the WAItE descriptive system. This example assumes that level ratings are obtained for each domain separately, therefore mathematics presented here differs to those presented elsewhere <span class="citation" data-cites="Schneider2022TheStates">(<a href="#ref-Schneider2022TheStates" role="doc-biblioref">P. P. Schneider et al. 2022</a>)</span>. Example response data are used for demonstration in this section and are presented in Table <span class="math inline">\(\ref{tab:example_raw_OPUF}\)</span>.</p>
<section id="example-responses" class="level3">
<h3 class="anchored" data-anchor-id="example-responses">Example responses</h3>
<p>Level ratings (presented in Table <span class="math inline">\(\ref{tab:example_raw_OPUF}\)</span>) are converted to coefficients bounded between 0-1 (shown in Equation <span class="math inline">\(\ref{eq:level_rescale}\)</span>). Level rating coefficients are presented in Matrix <span class="math inline">\(\ref{level_matrix}\)</span>. Attribute weights (presented in Table <span class="math inline">\(\ref{tab:example_raw_OPUF}\)</span>) are then normalised to sum to the value of 1 by dividing each weight by the sum of all weights (shown in Equation <span class="math inline">\(\ref{eq:weight_normalise}\)</span>). Normalised attribute weights are presented in Vector <span class="math inline">\(\ref{weight_vector}\)</span>.</p>
<p><span class="math display">\[\begin{equation}\label{eq:level_rescale}
    L_{ij} \cdot 0.01
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}\label{level_matrix}
L_{ij} =
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0.14 &amp; 0.26 &amp; 0.21 &amp; 0.15 &amp; 0.16 &amp; 0.12 &amp; 0.19 \\
0.57 &amp; 0.55 &amp; 0.63 &amp; 0.54 &amp; 0.38 &amp; 0.26 &amp; 0.66 \\
0.83 &amp; 0.82 &amp; 0.85 &amp; 0.86 &amp; 0.64 &amp; 0.38 &amp; 0.91 \\
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
\end{bmatrix}
\end{equation}\]</span> \ <span class="math display">\[\begin{equation}\label{eq:weight_normalise}
    \frac{w_{j}}{\sum{w_j}}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}\label{weight_vector}
w_j = \begin{bmatrix}
    0.08&amp; 0.10&amp; 0.11&amp; 0.14&amp; 0.30&amp; 0.10&amp; 0.17
\end{bmatrix}
\end{equation}\]</span> \ %%%%%%%%%%% combining weights and levels Combining the attribute weights (Vector <span class="math inline">\(\ref{weight_vector}\)</span>) with the level coefficients (Matrix <span class="math inline">\(\ref{level_matrix}\)</span>) via element-wise multiplication (shown in Equation <span class="math inline">\(\ref{eq:element_wise_multiplication}\)</span> gives the coefficient matrix presented in Matrix <span class="math inline">\(\ref{coeff_matrix}\)</span>. Once the coefficient matrix has been estimated, preference values can be estimated on the 0-1 QALY scale where the worst health state (PITS state denoted 5555555) is zero and the best health state (denoted 1111111) is one. These latent coefficients must now be rescaled to incorporate the results from the PITS anchoring task so that the minimum utility value possible is equal to the PITS value.</p>
<p><span class="math display">\[\begin{equation}\label{eq:element_wise_multiplication}
    L_{ij} \cdot  w_{j} = {\tilde{M}}_{ij}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}\label{coeff_matrix}
\tilde{M}_{ij} =  
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0.01 &amp; 0.03 &amp; 0.02 &amp; 0.02 &amp; 0.05 &amp; 0.01 &amp; 0.03 \\
0.05 &amp; 0.05 &amp; 0.07 &amp; 0.07 &amp; 0.11 &amp; 0.03 &amp; 0.11 \\
0.07 &amp; 0.08 &amp; 0.09 &amp; 0.12 &amp; 0.19 &amp; 0.04 &amp; 0.15 \\
0.08 &amp; 0.10 &amp; 0.11 &amp; 0.14 &amp; 0.30 &amp; 0.10 &amp; 0.17
\end{bmatrix}
\end{equation}\]</span> \ To rescale the latent coefficient matrix to incorporate the anchoring task, the coefficient matrix is multiplied by the compliment of the PITS value (shown in Equation <span class="math inline">\(\ref{eq:anchoring}\)</span>) to give the anchored coefficient matrix presented in Matrix <span class="math inline">\(\ref{ma:anchored_matrix}\)</span>.</p>
<p><span class="math display">\[\begin{equation}\label{eq:anchoring}
    \tilde{M}_{ij} \cdot (1-P) \quad \backepsilon \quad P = 0.2
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}\label{ma:anchored_matrix}
\tilde{V}_{ij} =  
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0.01 &amp; 0.02 &amp; 0.02 &amp; 0.02 &amp; 0.04 &amp; 0.01 &amp; 0.02 \\
0.04 &amp; 0.04 &amp; 0.06 &amp; 0.06 &amp; 0.09 &amp; 0.02 &amp; 0.09 \\
0.06 &amp; 0.06 &amp; 0.07 &amp; 0.10 &amp; 0.15 &amp; 0.03 &amp; 0.12 \\
0.06 &amp; 0.08 &amp; 0.09 &amp; 0.11 &amp; 0.24 &amp; 0.08 &amp; 0.14 \\
\end{bmatrix}
\end{equation}\]</span> \</p>
<p>Once the attribute and level labels are reintroduced to the anchored coefficient matrix this forms the value set which presents the disutility corresponding to each attribute level combination presented in the WAItE. Table <span class="math inline">\(\ref{example valueset}\)</span> presents the WAItE example PUF value set. Equations <span class="math inline">\(\ref{eq:HS1}\)</span> present examples of how to estimate a utility value given a specific WAItE health state.</p>
<p><span class="math display">\[\begin{equation}\label{eq:HS1}
\begin{aligned}
    
    \text{Health State [5555555]} &amp;\Rightarrow 1 - (0.06 + 0.08 + 0.09 + 0.11 + 0.24 + 0.08 + 0.14) = 0.20
    
    \text{Health State [5223445]} &amp;\Rightarrow 1 - (0.06 + 0.02 + 0.02 + 0.06 + 0.15 + 0.03 + 0.14) = 0.52
\end{aligned}
\end{equation}\]</span></p>
<p>%<span class="math display">\[\begin{equation}\label{eq:HS2}
    %\text{Health State [2222222]} \Rightarrow 1 - (0.03 + 0.02 + 0.01 + 0.01 + 0.02 + 0.02 + 0.04) = 0.85
%\end{equation}

## Aggregation to social utility function
The OPUF is designed to be able to estimate personal utility functions and so estimation occurs on an individual basis. Aggregating personal utility functions to a social utility function (SUF) takes place by taking a mean of all the individual personal utility functions from your sample. This operation is presented in Equation \ref{eq:mean_valueset}.

\begin{equation}\label{eq:mean_valueset}
\bar{V}_{{ij}} = \frac{\sum_{\tilde{V}_{{ij}}}^{}}{N}
\end{equation}\]</span></p>
</section>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="recruitment" class="level2">
<h2 class="anchored" data-anchor-id="recruitment">Recruitment</h2>
<p>This study recruited (n=300) adults to respond to a quality-of-life survey hosted online. Study participants were recruited based on specific quotas to form a representative sample based on UK census data. The survey was hosted on the platform which invited paid respondents to complete the Weight-specific Adolescent Instrument for Economic evaluation (WAItE) version of the Online Personal Utility Functions (OPUF) survey. A demonstration of the OPUF survey and questions is available . Informed consent was obtained at the outset of the survey and participants reserved the right to withdraw at any point without giving a reason. Participants who withdrew were not paid and their data deleted. Participation in this survey was estimated to take approximately fifteen minutes to complete and participants received £2.50 as a payment upon completion. This is in line with reimbursements rates from other OPUF studies <span class="citation" data-cites="Schneider2022TheStates Bray2024DevelopmentImpairment">(<a href="#ref-Schneider2022TheStates" role="doc-biblioref">P. P. Schneider et al. 2022</a>; <a href="#ref-Bray2024DevelopmentImpairment" role="doc-biblioref">Bray, Tudor Edwards, and Schneider 2024</a>)</span> and is in line with recommended reimbursement rates from Prolific (). The survey was designed to be an unassisted survey administered online (no face-to-face contact) and no identifiable data was collected. Statistical analysis was conducted on the survey data. Newcastle University Medical School Ethics Committee approved this study (reference 49737/2023). The survey structure is detailed in <a href="#sec-surveystructure" class="quarto-xref">Section&nbsp;2.2</a>.</p>
</section>
<section id="sec-surveystructure" class="level2">
<h2 class="anchored" data-anchor-id="sec-surveystructure">Survey structure</h2>
<ol type="1">
<li>Consent and Prolific ID: Participants were asked to consent to participate and enter their unique Prolific ID. This enables demographic information held by Prolific on their participants to be linked to each respondent.</li>
<li>WAItE descriptive system: Participants were asked to complete the WAItE descriptive system (presented in Figure <span class="math inline">\(\ref{fig:waite_descriptive}\)</span>)to describe their current health state.</li>
<li>Dimension selection}: Participants were presented with the worst level for each WAItE dimension and asked to choose which health problem would have the most negative impact on their quality of life. The dimension chosen is then used in the subsequent dimension swing weighting task.<br>
</li>
<li>Dimension swing weighting: Participants were presented with each dimension in the WAItE and asked to consider an improvement from the worst level of that dimension to the best level of that dimension. Participants were asked to rank this improvement on a visual slider from 0-100 where the most important dimension (chosen in the previous task) is fixed at 100. Participants were reminded to use their most important dimension as a reference point.<br>
</li>
<li>Level rating: Participants were presented with a specific dimension of the WAItE and shown each level within that dimension. Levels best and worst (never and always) were fixed at 0 and 100 respectively. Participants were asked to rank the intermediate levels within each dimension using the fixed levels as a reference point.</li>
<li>Anchoring: Participants were presented with a binary choice asking whether they prefer the worst state of the WAItE (PITS state) or death. If participants choose the worst state of the WAItE, a second question is asked which asks them to rank the WAITE PITS state on a visual analogue scale where zero is labelled as being dead and one hundred is labelled as no health problems. If participants choose death in the binary choice, they were asked to rank being dead on a visual analogue scale where zero is labelled as the WAItE PITS state and one hundred is labelled as no health problems.</li>
<li>Survey feedback and demographic questions: Participants were asked about how difficult they found the task to complete and demographic information on age, gender, ethnicity, education, employment and weight status.</li>
</ol>
</section>
<section id="live-survey" class="level2">
<h2 class="anchored" data-anchor-id="live-survey">Live survey</h2>
<iframe width="800" height="600" src="https://survey.valorem.health/waite_opuf_adult2" title="Information"></iframe>
</section>
<section id="missing-data" class="level2">
<h2 class="anchored" data-anchor-id="missing-data">Missing data</h2>
<p>Through the survey design process the potential for large amounts of missing data has been mitigated by ensuring responses were compulsory to certain questions. However for ethical reasons, we allowed participants to not answer the questions relating to death. For participants who do not provide responses to the anchoring questions, their responses were imputed using multiple imputation by chained equations (MICE) <span class="citation" data-cites="White2011MultiplePractice">(<a href="#ref-White2011MultiplePractice" role="doc-biblioref">White, Royston, and Wood 2011</a>)</span> which were informed by demographic information and dimension weighting responses.</p>
</section>
<section id="preference-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="preference-heterogeneity">Preference heterogeneity</h2>
<p>As personal utility function are estimated on an individual basis, exploring preference heterogeneity between individuals in the sample is straightforward. Investigating the heterogeneity of preferences between individuals, requires a measure of dis/similarity to quantify how far apart two PUFs are <span class="citation" data-cites="Schneider2024ExploringLevel">(<a href="#ref-Schneider2024ExploringLevel" role="doc-biblioref">P. Schneider et al. 2024</a>)</span>. The measurement and estimation of preference heterogeneity in this section will follow methods detailed by Schneider et al.&nbsp;(2024) <span class="citation" data-cites="Schneider2024ExploringLevel">(<a href="#ref-Schneider2024ExploringLevel" role="doc-biblioref">P. Schneider et al. 2024</a>)</span>. Each PUF estimated in this study was represented by a vector of 78,125 health state utility values for each respondent in the sample. In order to assess the dis/similarity between these PUFs, we used the euclidean difference measure (EUD). Analogous to a line between two points on a two dimensional plane, the EUD between two PUFs denotes the shortest path length in a 78,125 dimensional space. It is computed as the square root of the sum of the squared differences between the PUFs of individuals (i) and (j) (presented in Equation <span class="math inline">\(\ref{eq:EUD}\)</span>). Once PUFs have been estimated for all individuals in the sample, pairwise EUD was estimated for all possible pairwise combinations within the sample. Pairwise EUD was stored in an [N () N] distance matrix.</p>
<p><span class="math display">\[\begin{equation} \label{eq:EUD}
  \begin{aligned}
    d_{EUD}(i,j) &amp; =\sqrt{\sum_{}^{}(u_{i}(s_{1})-u_{j}(s_{1}))^{2}+ ... +(u_{i}(s_{78125})-u_{j}(s_{78125}))^{2}}\\
      &amp; \backepsilon \quad \quad s = \{1111111, 2111111, ..., 5555555\}\\
  \end{aligned}
\end{equation}\]</span></p>
</section>
<section id="permutational-analysis-of-variance" class="level2">
<h2 class="anchored" data-anchor-id="permutational-analysis-of-variance">Permutational analysis of variance</h2>
<p>Permutational analysis of variance (PERMANOVA), analogous to analysis of variance, is a geometric partitioning of variation across a multivariate data cloud, definied in the space of any given dissimilarity measure, in response to one or more groups [<span class="citation" data-cites="Anderson2017">Anderson (<a href="#ref-Anderson2017" role="doc-biblioref">2017</a>)</span>; Anderson2013PERMANOVATesting]. This method of statistical testing has been used most commonly in ecological research to test for population dispersion among different subgroups <span class="citation" data-cites="Souza2013PopulationEstuary">(<a href="#ref-Souza2013PopulationEstuary" role="doc-biblioref">Souza et al. 2013</a>)</span>. PERMANOVA decomposes the total distances between observations (SS(_T)) into within-groups (SS(_W)) and between groups sum-of-squares (SS(_B)). Equation <span class="math inline">\(\ref{eq:sumsquares}\)</span> details the estimation of total and within-groups sum-of-squares. Mathematical notation presented here is reproduced from Schneider et al.&nbsp;(2024) <span class="citation" data-cites="Schneider2024ExploringLevel">(<a href="#ref-Schneider2024ExploringLevel" role="doc-biblioref">P. Schneider et al. 2024</a>)</span> for consistency.</p>
<p><span class="math display">\[\begin{equation} \label{eq:sumsquares}
    SS_{T} = \frac{1}{N}\sum_{i=1}^{N-1}\sum_{j=i+1}^{N}d(i,j)^{2}; \quad SS_{W} = \sum_{i=1}^{N-1}\sum_{j=i+1}^{N}d(i,j)^{2}\epsilon_{ij}^{\ell}/n_{\ell}
\end{equation}\]</span></p>
<p>where N is the total sample size (=300), (d(i,j)^2) is the squared distance between the PUFs of participants (i) and (j), (<em>{i,j}) indicator which is 1, if participants (i) and (j) belong to the same group, and 0 if they do not, and (n</em>{}) is the size for group (). Then, SS(_B) can then be calculated as SS(_B) = SS(T) – SS(_W), which allows calculating the pseudo F statistic for (p) groups:</p>
<p><span class="math display">\[\begin{equation}
    F= \frac{(\frac{SS_B}{p-1})}{(\frac{SS_W}{N-p})}
\end{equation}\]</span></p>
<p>Further details about the mathematical and statistical properties of PERMANOVA are available elsewhere [<span class="citation" data-cites="Schneider2024ExploringLevel">P. Schneider et al. (<a href="#ref-Schneider2024ExploringLevel" role="doc-biblioref">2024</a>)</span>; Anderson2017; Anderson2013PERMANOVATesting]. In this study, we used PERMANOVA to explore the variability in WAItE health state preferences (individual value sets) between various subgroups. A multivariate PERMANOVA model was estimated with subgroups of: age, gender, self-reported weight status, education, employment status and ethncity.</p>
</section>
<section id="sensitivity-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sensitivity-analysis">Sensitivity analysis</h2>
<p>In an experimental sensitivity analysis, preference heterogeneity was assessed using EUD estimated based on individual’s personal utility functions anchored using the social PITS utility value (henceforth referred to as EUD2). This differed to prior preference heterogeneity estimation as individual variation in PITS utility values were not included in the EUD2 estimation. EUD2 was entirely composed by differences in level ratings and domain weights. Further details on the derivation of EUD2 are presented in Appendix <span class="math inline">\(\ref{app:EUD_derivation}\)</span>.</p>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<section id="study-participants" class="level2">
<h2 class="anchored" data-anchor-id="study-participants">Study participants</h2>
<p>A sample of 334 individuals were approached to participate in the study via the survey company . Individuals that successfully inputted their unique Prolific ID and obtained a correct completion code from the end of the study were included in the analysis sample and received a small payment (£2.50) for their participation. Seven participants were excluded from the study as they had an incorrect completion code and did not enter the correct unique Prolific ID. Therefore no data was available on those seven participants and so they were excluded from the analysis. An additional participant was excluded from the analysis due to completing the survey in eighteen seconds (well under the prespecified minimum time limit of 2 minutes). Two respondents timed-out while completing the survey and were therefore not included. Twenty-four individuals chose not complete the study (referred to by Prolific as `returned’ participants). This left an analysis sample of N=300 participants who successfully completed the survey. A representative sample based on UK census data was obtained from Prolific. A summary of demographic information collected in the OPUF are presented in Table <span class="math inline">\(\ref{tab:demographicdataadultOPUF}\)</span>.</p>
</section>
<section id="survey-duration" class="level2">
<h2 class="anchored" data-anchor-id="survey-duration">Survey duration</h2>
<p>The mean (SD) and median (IQR) survey completion time in minutes was 9.66 (5.85) and 8.15 (5.88; 11.89). <a href="#tbl-time" class="quarto-xref">Table&nbsp;1</a> summarises how much time was spent completing each individual section of the survey.</p>
<div class="cell">
<div id="tbl-time" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Survey completion times (secs)
</figcaption>
<div aria-describedby="tbl-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 29%">
<col style="width: 20%">
<col style="width: 30%">
<col style="width: 8%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Section</th>
<th style="text-align: left;">Mean (SD)</th>
<th style="text-align: left;">Median (Q1; Q3)</th>
<th style="text-align: left;">Min</th>
<th style="text-align: left;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">WAItE</td>
<td style="text-align: left;">73 (90.1)</td>
<td style="text-align: left;">53 (38; 77)</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">1066</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dimension ranking</td>
<td style="text-align: left;">35.4 (50.6)</td>
<td style="text-align: left;">26 (16; 40)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">741</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dimension weighting</td>
<td style="text-align: left;">115.7 (94.9)</td>
<td style="text-align: left;">91.5 (69.8; 142.2)</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">1380</td>
</tr>
<tr class="even">
<td style="text-align: left;">Level rating</td>
<td style="text-align: left;">220.5 (206.4)</td>
<td style="text-align: left;">171 (119; 249)</td>
<td style="text-align: left;">34</td>
<td style="text-align: left;">2158</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PITS vs death</td>
<td style="text-align: left;">25.5 (45.4)</td>
<td style="text-align: left;">16.5 (11; 25.2)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">620</td>
</tr>
<tr class="even">
<td style="text-align: left;">PITS-VAS</td>
<td style="text-align: left;">37.3 (39.2)</td>
<td style="text-align: left;">29 (21; 45)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">605</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PITS-VAS</td>
<td style="text-align: left;">37.3 (39.2)</td>
<td style="text-align: left;">29 (21; 45)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">605</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total (secs)</td>
<td style="text-align: left;">579.5 (351.1)</td>
<td style="text-align: left;">489.2 (352.5; 713.4)</td>
<td style="text-align: left;">126.7</td>
<td style="text-align: left;">3738.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total (mins)</td>
<td style="text-align: left;">9.66 (5.85)</td>
<td style="text-align: left;">8.15 (5.88; 11.89)</td>
<td style="text-align: left;">2.11</td>
<td style="text-align: left;">62.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="waite-descriptive-system" class="level2">
<h2 class="anchored" data-anchor-id="waite-descriptive-system">WAItE descriptive system</h2>
<p>Responses to the WAItE descriptive system are presented in Table <span class="math inline">\(\ref{tab:demographicdataadultOPUF}\)</span>. Feeling tired and avoiding doing sport were the domains that were most frequently experienced by participants in our analysis sample. WAItE summary statistics were in line with results from previous studies <span class="citation" data-cites="Robinson2019EstimatingEvaluation">(<a href="#ref-Robinson2019EstimatingEvaluation" role="doc-biblioref">Robinson and Oluboyede 2019</a>)</span>.</p>
</section>
<section id="level-ratings" class="level2">
<h2 class="anchored" data-anchor-id="level-ratings">Level ratings</h2>
<p>Level ratings are presented individually for each different domain in <a href="#tbl-level" class="quarto-xref">Table&nbsp;2</a>. The best and worst levels ( and ) were fixed at 0 and 100 respectively. The second best level () had the lowest VAS score in the Sports and Embarrassment domain, while the second worst level () had the highest VAS score in the Concentration domain. In this question, higher VAS scores indicate worse states of health.</p>
<div class="cell">
<div id="tbl-level" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-level-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Summary of OPUF level ratings by domain
</figcaption>
<div aria-describedby="tbl-level-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Section</th>
<th style="text-align: left;">Mean (SD)</th>
<th style="text-align: left;">Median (Q1; Q3)</th>
<th style="text-align: left;">Min</th>
<th style="text-align: left;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Almost never</td>
<td style="text-align: left;">20.323 (23.208)</td>
<td style="text-align: left;">10 (5; 25)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sometimes</td>
<td style="text-align: left;">36.31 (19.185)</td>
<td style="text-align: left;">33.5 (20; 50)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Often</td>
<td style="text-align: left;">62.217 (23.934)</td>
<td style="text-align: left;">70 (50; 80)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Almost never</td>
<td style="text-align: left;">19.39 (21.839)</td>
<td style="text-align: left;">10 (6; 21)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sometimes</td>
<td style="text-align: left;">37.677 (19.373)</td>
<td style="text-align: left;">40 (24; 50)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Often</td>
<td style="text-align: left;">62.967 (26.167)</td>
<td style="text-align: left;">71 (50; 80)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Almost never</td>
<td style="text-align: left;">16.63 (20.978)</td>
<td style="text-align: left;">10 (5; 20)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sometimes</td>
<td style="text-align: left;">29.487 (22.015)</td>
<td style="text-align: left;">25 (10; 45)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Often</td>
<td style="text-align: left;">49.843 (29.624)</td>
<td style="text-align: left;">50.5 (24.5; 75)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Almost never</td>
<td style="text-align: left;">21.393 (22.1)</td>
<td style="text-align: left;">14 (7; 25)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sometimes</td>
<td style="text-align: left;">41.56 (20.101)</td>
<td style="text-align: left;">40 (25.8; 53.2)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Often</td>
<td style="text-align: left;">64.503 (26.195)</td>
<td style="text-align: left;">73 (50; 80.2)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Almost never</td>
<td style="text-align: left;">16.59 (22.292)</td>
<td style="text-align: left;">10 (4; 20)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sometimes</td>
<td style="text-align: left;">29.417 (21.615)</td>
<td style="text-align: left;">25 (10; 50)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Often</td>
<td style="text-align: left;">47.91 (30.445)</td>
<td style="text-align: left;">50 (20; 75)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Almost never</td>
<td style="text-align: left;">21.13 (22.235)</td>
<td style="text-align: left;">13 (6; 25)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sometimes</td>
<td style="text-align: left;">41.363 (22.128)</td>
<td style="text-align: left;">41.5 (25; 56)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Often</td>
<td style="text-align: left;">63.557 (28.187)</td>
<td style="text-align: left;">75 (50; 85)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Almost never</td>
<td style="text-align: left;">20.93 (24.366)</td>
<td style="text-align: left;">11 (5; 25)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sometimes</td>
<td style="text-align: left;">35.52 (22.774)</td>
<td style="text-align: left;">34.5 (19.8; 50)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Often</td>
<td style="text-align: left;">55.857 (30.552)</td>
<td style="text-align: left;">60.5 (31; 80)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="domain-weights" class="level2">
<h2 class="anchored" data-anchor-id="domain-weights">Domain weights</h2>
<p>Summary statistics of domain weightings are presented in <a href="#tbl-domain" class="quarto-xref">Table&nbsp;3</a>. On average, Tiredness (76.5) and Unhappiness (70) were considered to be more important to participants than Embarrassment (40.1) and Sports (42.3). There was less variability in domain weighting responses to Tiredness than responses to Treated differently or Embarrassment. %TODO: Add relative attribute importance section with normalised RAI score</p>
<div class="cell">
<div id="tbl-domain" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-domain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Summary of OPUF domain weights and anchoring responses
</figcaption>
<div aria-describedby="tbl-domain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 35%">
<col style="width: 23%">
<col style="width: 26%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Section</th>
<th style="text-align: left;">Mean (SD)</th>
<th style="text-align: left;">Median (Q1; Q3)</th>
<th style="text-align: left;">Min</th>
<th style="text-align: left;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tired</td>
<td style="text-align: left;">76.513 (28.358)</td>
<td style="text-align: left;">90 (60; 100)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Walking</td>
<td style="text-align: left;">65.53 (32.49)</td>
<td style="text-align: left;">75 (40; 100)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sports</td>
<td style="text-align: left;">42.32 (32.81)</td>
<td style="text-align: left;">35 (11; 70)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Concentration</td>
<td style="text-align: left;">67.897 (30.949)</td>
<td style="text-align: left;">80 (44; 99.2)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Embarrassment</td>
<td style="text-align: left;">40.143 (34.344)</td>
<td style="text-align: left;">30 (9; 70)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unhappiness</td>
<td style="text-align: left;">69.997 (31.946)</td>
<td style="text-align: left;">80 (50; 100)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treated differently</td>
<td style="text-align: left;">52.093 (35.564)</td>
<td style="text-align: left;">50 (15.8; 86)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PITS preferred to death</td>
<td style="text-align: left;">0.879 (0.327)</td>
<td style="text-align: left;">1 (1; 1)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PITS-VAS</td>
<td style="text-align: left;">56.057 (31.287)</td>
<td style="text-align: left;">54 (30; 85)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dead-VAS</td>
<td style="text-align: left;">42.528 (31.583)</td>
<td style="text-align: left;">38.5 (13.2; 63.5)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PITS VAS uncensored</td>
<td style="text-align: left;">-0.025 (5.95)</td>
<td style="text-align: left;">0.5 (0.2; 0.8)</td>
<td style="text-align: left;">-99</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PITS VAS censored</td>
<td style="text-align: left;">0.431 (0.485)</td>
<td style="text-align: left;">0.5 (0.2; 0.8)</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PITS Utility Value</td>
<td style="text-align: left;">0.282 (1.456)</td>
<td style="text-align: left;">0.5 (0.2; 0.8)</td>
<td style="text-align: left;">-14.3</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="anchoring" class="level2">
<h2 class="anchored" data-anchor-id="anchoring">Anchoring</h2>
<p>The majority of respondents in the sample preferred the WAItE PITS state to being dead (87%). Therefore, 13% of participants answered the dead-VAS and 87% answered the PITS-VAS. A proportion of participants did not answer the anchoring task (1.67%). After winsorizing extreme values (top and bottom 0.1%) <span class="citation" data-cites="2003ApplyingTechniques">(<a href="#ref-2003ApplyingTechniques" role="doc-biblioref"><em><span>Applying Contemporary Statistical Techniques</span></em> 2003</a>)</span> and conducting multiple imputation by chained equations on the missing values, the mean (SD) and median (IQR) PITS utility value was 0.282 (1.456) and 0.5 (0.6). The distribution of WAItE PITS utility values (after winsorizing and imputation) is presented in <a href="#fig-hist" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hesg_paper_files/figure-html/fig-hist-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Distribution of PITS utility values
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="social-utility-function-estimation" class="level2">
<h2 class="anchored" data-anchor-id="social-utility-function-estimation">Social utility function estimation</h2>
<p>Personal utility functions were estimated individually for each participant in our analysis sample via methods outlined in <a href="#sec-OPUF_methods" class="quarto-xref">Section&nbsp;1.4</a>. After this, individual PUFs were aggregated into a group utility function and anchored using the group PITS utility value (0.282) to give the social utility function. Descriptive statistics from the social utility function are presented in <a href="#tbl-suf" class="quarto-xref">Table&nbsp;4</a> whereby the mean values can be used to estimate utility values for WAItE health states.</p>
<div class="cell">
<div id="tbl-suf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-suf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Social utility function based on 300 PUFs
</figcaption>
<div aria-describedby="tbl-suf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 38%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Dimension Level</th>
<th style="text-align: left;">Mean (95% CI)</th>
<th style="text-align: left;">Median (Q1; Q3)</th>
<th style="text-align: left;">Min</th>
<th style="text-align: left;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">tired, almost never</td>
<td style="text-align: left;">0.029 (0.025; 0.033)</td>
<td style="text-align: left;">0.029 (0.027; 0.03)</td>
<td style="text-align: left;">0.021</td>
<td style="text-align: left;">0.039</td>
</tr>
<tr class="even">
<td style="text-align: left;">tired, sometimes</td>
<td style="text-align: left;">0.052 (0.048; 0.057)</td>
<td style="text-align: left;">0.052 (0.05; 0.054)</td>
<td style="text-align: left;">0.042</td>
<td style="text-align: left;">0.062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tired, often</td>
<td style="text-align: left;">0.088 (0.082; 0.094)</td>
<td style="text-align: left;">0.088 (0.085; 0.09)</td>
<td style="text-align: left;">0.077</td>
<td style="text-align: left;">0.103</td>
</tr>
<tr class="even">
<td style="text-align: left;">tired, always</td>
<td style="text-align: left;">0.14 (0.133; 0.148)</td>
<td style="text-align: left;">0.14 (0.137; 0.143)</td>
<td style="text-align: left;">0.125</td>
<td style="text-align: left;">0.157</td>
</tr>
<tr class="odd">
<td style="text-align: left;">walk, almost never</td>
<td style="text-align: left;">0.021 (0.018; 0.024)</td>
<td style="text-align: left;">0.021 (0.02; 0.022)</td>
<td style="text-align: left;">0.016</td>
<td style="text-align: left;">0.027</td>
</tr>
<tr class="even">
<td style="text-align: left;">walk, sometimes</td>
<td style="text-align: left;">0.045 (0.041; 0.049)</td>
<td style="text-align: left;">0.045 (0.043; 0.046)</td>
<td style="text-align: left;">0.037</td>
<td style="text-align: left;">0.052</td>
</tr>
<tr class="odd">
<td style="text-align: left;">walk, often</td>
<td style="text-align: left;">0.075 (0.069; 0.082)</td>
<td style="text-align: left;">0.075 (0.073; 0.077)</td>
<td style="text-align: left;">0.064</td>
<td style="text-align: left;">0.087</td>
</tr>
<tr class="even">
<td style="text-align: left;">walk, always</td>
<td style="text-align: left;">0.116 (0.108; 0.124)</td>
<td style="text-align: left;">0.115 (0.113; 0.118)</td>
<td style="text-align: left;">0.101</td>
<td style="text-align: left;">0.131</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sports, almost never</td>
<td style="text-align: left;">0.012 (0.01; 0.015)</td>
<td style="text-align: left;">0.012 (0.012; 0.013)</td>
<td style="text-align: left;">0.009</td>
<td style="text-align: left;">0.017</td>
</tr>
<tr class="even">
<td style="text-align: left;">sports, sometimes</td>
<td style="text-align: left;">0.023 (0.02; 0.025)</td>
<td style="text-align: left;">0.023 (0.022; 0.024)</td>
<td style="text-align: left;">0.018</td>
<td style="text-align: left;">0.029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sports, often</td>
<td style="text-align: left;">0.038 (0.034; 0.044)</td>
<td style="text-align: left;">0.038 (0.037; 0.04)</td>
<td style="text-align: left;">0.029</td>
<td style="text-align: left;">0.052</td>
</tr>
<tr class="even">
<td style="text-align: left;">sports, always</td>
<td style="text-align: left;">0.069 (0.063; 0.076)</td>
<td style="text-align: left;">0.069 (0.067; 0.071)</td>
<td style="text-align: left;">0.058</td>
<td style="text-align: left;">0.084</td>
</tr>
<tr class="odd">
<td style="text-align: left;">concentrate, almost never</td>
<td style="text-align: left;">0.026 (0.023; 0.03)</td>
<td style="text-align: left;">0.026 (0.025; 0.028)</td>
<td style="text-align: left;">0.019</td>
<td style="text-align: left;">0.034</td>
</tr>
<tr class="even">
<td style="text-align: left;">concentrate, sometimes</td>
<td style="text-align: left;">0.051 (0.047; 0.055)</td>
<td style="text-align: left;">0.051 (0.049; 0.052)</td>
<td style="text-align: left;">0.044</td>
<td style="text-align: left;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">concentrate, often</td>
<td style="text-align: left;">0.08 (0.074; 0.086)</td>
<td style="text-align: left;">0.08 (0.078; 0.082)</td>
<td style="text-align: left;">0.069</td>
<td style="text-align: left;">0.093</td>
</tr>
<tr class="even">
<td style="text-align: left;">concentrate, always</td>
<td style="text-align: left;">0.121 (0.114; 0.128)</td>
<td style="text-align: left;">0.121 (0.118; 0.123)</td>
<td style="text-align: left;">0.107</td>
<td style="text-align: left;">0.138</td>
</tr>
<tr class="odd">
<td style="text-align: left;">embarrassment, almost never</td>
<td style="text-align: left;">0.012 (0.01; 0.014)</td>
<td style="text-align: left;">0.012 (0.011; 0.013)</td>
<td style="text-align: left;">0.008</td>
<td style="text-align: left;">0.017</td>
</tr>
<tr class="even">
<td style="text-align: left;">embarrassment, sometimes</td>
<td style="text-align: left;">0.022 (0.019; 0.025)</td>
<td style="text-align: left;">0.022 (0.021; 0.023)</td>
<td style="text-align: left;">0.016</td>
<td style="text-align: left;">0.027</td>
</tr>
<tr class="odd">
<td style="text-align: left;">embarrassment, often</td>
<td style="text-align: left;">0.034 (0.03; 0.038)</td>
<td style="text-align: left;">0.034 (0.032; 0.035)</td>
<td style="text-align: left;">0.025</td>
<td style="text-align: left;">0.043</td>
</tr>
<tr class="even">
<td style="text-align: left;">embarrassment, always</td>
<td style="text-align: left;">0.061 (0.056; 0.067)</td>
<td style="text-align: left;">0.061 (0.059; 0.063)</td>
<td style="text-align: left;">0.051</td>
<td style="text-align: left;">0.072</td>
</tr>
<tr class="odd">
<td style="text-align: left;">unhappiness, almost never</td>
<td style="text-align: left;">0.025 (0.022; 0.029)</td>
<td style="text-align: left;">0.025 (0.024; 0.026)</td>
<td style="text-align: left;">0.019</td>
<td style="text-align: left;">0.033</td>
</tr>
<tr class="even">
<td style="text-align: left;">unhappiness, sometimes</td>
<td style="text-align: left;">0.054 (0.049; 0.059)</td>
<td style="text-align: left;">0.054 (0.052; 0.056)</td>
<td style="text-align: left;">0.045</td>
<td style="text-align: left;">0.064</td>
</tr>
<tr class="odd">
<td style="text-align: left;">unhappiness, often</td>
<td style="text-align: left;">0.083 (0.076; 0.09)</td>
<td style="text-align: left;">0.083 (0.081; 0.086)</td>
<td style="text-align: left;">0.07</td>
<td style="text-align: left;">0.101</td>
</tr>
<tr class="even">
<td style="text-align: left;">unhappiness, always</td>
<td style="text-align: left;">0.124 (0.117; 0.133)</td>
<td style="text-align: left;">0.124 (0.122; 0.127)</td>
<td style="text-align: left;">0.11</td>
<td style="text-align: left;">0.142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treated differently, almost never</td>
<td style="text-align: left;">0.019 (0.016; 0.022)</td>
<td style="text-align: left;">0.019 (0.017; 0.02)</td>
<td style="text-align: left;">0.013</td>
<td style="text-align: left;">0.025</td>
</tr>
<tr class="even">
<td style="text-align: left;">treated differently, sometimes</td>
<td style="text-align: left;">0.035 (0.03; 0.039)</td>
<td style="text-align: left;">0.035 (0.033; 0.036)</td>
<td style="text-align: left;">0.026</td>
<td style="text-align: left;">0.043</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treated differently, often</td>
<td style="text-align: left;">0.052 (0.047; 0.058)</td>
<td style="text-align: left;">0.052 (0.05; 0.054)</td>
<td style="text-align: left;">0.041</td>
<td style="text-align: left;">0.063</td>
</tr>
<tr class="even">
<td style="text-align: left;">treated differently, always</td>
<td style="text-align: left;">0.087 (0.079; 0.095)</td>
<td style="text-align: left;">0.087 (0.084; 0.089)</td>
<td style="text-align: left;">0.071</td>
<td style="text-align: left;">0.101</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#fig-sufplain" class="quarto-xref">Figure&nbsp;2</a> presents the mean social utility function (thick line) alongside individual personal utility functions (thin lines) for a selection of 100 WAItE health states ordered from high to low utility according to the social preference. Deviations of individual utility functions from the social preference illustrate the heterogeneity of preference within our analysis sample. Individual personal utility functions shown in <a href="#fig-sufplain" class="quarto-xref">Figure&nbsp;2</a> are anchored using individual PITS utility values rather than the social PITS utility value.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sufplain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sufplain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hesg_paper_files/figure-html/fig-sufplain-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sufplain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Social and individual utility functions
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="preference-heterogeneity-1" class="level2">
<h2 class="anchored" data-anchor-id="preference-heterogeneity-1">Preference heterogeneity</h2>
<p>After estimating individual PUFs for all participants, pairwise EUD was estimated between all participants. This yielded a [300 () 300] distance matrix with 44,850 unique pairwise comparisons. The mean (SD) and median (IQR) EUD were 47.60 (19.40) and 44.81 (34.06; 57.40). The highest and lowest observed EUD were 189.16 and 0. <a href="#fig-eud" class="quarto-xref">Figure&nbsp;3</a> illustrates the relationship between EUD and WAItE health states. EUD tends to increase as WAItE health states worsen. That is, as the severity of WAItE health states increases, the more heterogeneous preferences become among our sample.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-eud" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eud-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hesg_paper_files/figure-html/fig-eud-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eud-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Social and individual utility functions coloured by EUD
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#tbl-permanova" class="quarto-xref">Table&nbsp;5</a> presents the PERMANOVA model results. Presented are within‐group sum‐of‐squares (SS(_W)) for each group individually and for all groups combined, and the corresponding R(^2), pseudo (F), and (p) values. Preference heterogeneity was significantly affected by age ((p) = 0.03), though the amount of variability in preferences that could be explained by age was relatively small (R(^2)=5.7%). <a href="#fig-age" class="quarto-xref">Figure&nbsp;4</a> presents the difference in preferences between different age groups. Generally, as age increases, health state utility values for each given WAItE health state are higher. That is, younger populations tend to place more disutility on WAItE health problems than older populations. While weight status was not significantly related to preference heterogeneity according to the PERMANOVA model, given the WAItE is a weight-specific measure, it was informative to explore the relationship between preferences and weight status. Though not statistically significant, we can observe a difference in preferences between normal weight and overweight individuals in <a href="#fig-weight" class="quarto-xref">Figure&nbsp;5</a>. For a given WAItE health state, overweight individuals in our sample placed less disutility on that state than did normal weight individuals.</p>
<div class="cell">
<div id="tbl-permanova" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-permanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Results of PERMANOVA – testing for differences in WAItE health state preferences between group characteristics
</figcaption>
<div aria-describedby="tbl-permanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">SumOfSqs</th>
<th style="text-align: right;">R2</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age_factor</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8103.932</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">2.012</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">weightdata</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2957.825</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">1.102</td>
<td style="text-align: right;">0.321</td>
</tr>
<tr class="odd">
<td style="text-align: left;">educationdata</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4307.037</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">1.283</td>
<td style="text-align: right;">0.136</td>
</tr>
<tr class="even">
<td style="text-align: left;">occupationdata</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4180.638</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.890</td>
<td style="text-align: right;">0.659</td>
</tr>
<tr class="odd">
<td style="text-align: left;">genderdata</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">723.163</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.359</td>
<td style="text-align: right;">0.986</td>
</tr>
<tr class="even">
<td style="text-align: left;">ethnicitydata</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2963.218</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">1.104</td>
<td style="text-align: right;">0.312</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">181227.225</td>
<td style="text-align: right;">0.886</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">299</td>
<td style="text-align: right;">204463.039</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hesg_paper_files/figure-html/fig-age-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Social and individual utility functions grouped by age status
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sensitivity-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="sensitivity-analysis-1">Sensitivity analysis</h2>
<p>EUD2 was estimated for each pairwise comparison of individuals in our study. This yielded a [300 () 300] distance matrix with 44,850 unique pairwise comparisons. The mean (SD) and median (IQR) EUD were 34.30 (13.82) and 32.25 (24.54; 41.27). Results from the PERMANOVA2 analysis are presented in <a href="#tbl-permanova2" class="quarto-xref">Table&nbsp;6</a>. After exclusion of individual variation in anchoring responses, weight status and age had a significant impact upon heterogeneity within our sample; though the amount of heterogeneity that was explained by these variables was fairly small (4.9%).</p>
<div class="cell">
<div id="tbl-permanova2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-permanova2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Results of PERMANOVA2 – testing for differences in level rating and domain weighting preferences between group characteristics
</figcaption>
<div aria-describedby="tbl-permanova2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">SumOfSqs</th>
<th style="text-align: right;">R2</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age_factor</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8103.932</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">2.012</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">weightdata</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2957.825</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">1.102</td>
<td style="text-align: right;">0.321</td>
</tr>
<tr class="odd">
<td style="text-align: left;">educationdata</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4307.037</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">1.283</td>
<td style="text-align: right;">0.136</td>
</tr>
<tr class="even">
<td style="text-align: left;">occupationdata</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4180.638</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.890</td>
<td style="text-align: right;">0.659</td>
</tr>
<tr class="odd">
<td style="text-align: left;">genderdata</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">723.163</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.359</td>
<td style="text-align: right;">0.986</td>
</tr>
<tr class="even">
<td style="text-align: left;">ethnicitydata</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2963.218</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">1.104</td>
<td style="text-align: right;">0.312</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">181227.225</td>
<td style="text-align: right;">0.886</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">299</td>
<td style="text-align: right;">204463.039</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>This study is the first time that the OPUF has been used to estimate health state utility values for the WAItE. We obtained a representative sample of high quality data from Prolific, a survey company known for their high quality respondents <span class="citation" data-cites="Peer2022DataResearch">(<a href="#ref-Peer2022DataResearch" role="doc-biblioref">Peer et al. 2022</a>)</span>. Our average domain weightings and implied ordering were similar to those exhibited in Robinson et al.&nbsp;(XX VIH).</p>
<p>Anchoring of the WAItE PITS state was a difficult procedure that required a number of methodological decisions. We decided to use uncensored responses to the Dead-VAS task which meant that data from one respondent (-99) skewed the mean PITS utility value quite substantially. To mitigate the impact of extreme values on the mean, we conducted winsorization of values lying in the outer 0.1% of the distribution. This practice, while effective at limiting the influence of extreme values on the mean, could understate the genuine variability in the data. Though, it is likely that exclusion of this participant would have had a more detrimental effect to presenting the genuine variability of responses.</p>
<p>The social utility function elicited through this study, and underlying utility value set, present monotonic preferences which behave as we would have expected ex-ante (based on qualitative piloting work). Tiredness and Unhappiness were considered the most important domains while Embarrassment and Sports the least. This finding concurs with qualitative work conducted prior and also is in accordance with previous valuation work done with the WAItE (XX VIH). Prior valuation work, which used a DCE to elicit preferences, yielded latent coefficients which violated the rational choice axiom of monotonicity. In the OPUF, monotonicity is somewhat forced through the choice architecture of the level rating and through the additional prompt to reconsider responses that are not monotonic. Forced monotonicity, in this context, could be problematic for eliciting unbiased preferences if preferences for certain health states are truly not monotonic. For example, prior qualitative work has suggested that “I almost never get tired” might be preferable to “I never get tired” in some circumstances where respondents are thinking about experiencing insomnia and sleep quality. This being said, the WAItE descriptive system was designed to be a monotonic descriptive system, validated using Rasch analysis, and so having a monotonic utility value set makes logical sense.</p>
<p>Preferences elicited through this study were considerably heterogeneous. This can be understood through the mean EUD value (47.6) but also illustrated in <a href="#fig-sufplain" class="quarto-xref">Figure&nbsp;2</a> through the deviations of individual PUFs from the social utility function. Following on from prior work <span class="citation" data-cites="Schneider2024ExploringLevel">(<a href="#ref-Schneider2024ExploringLevel" role="doc-biblioref">P. Schneider et al. 2024</a>)</span>, we estimated EUD by calculating a distance matrix between each pairwise comparison of individual value sets for all 78125 WAItE health states. The implication of estimating distance (preference heterogeneity) by using individual value sets allows for much of the preference heterogeneity that exists to be composed of differences in individual anchoring values (PITS state responses) rather than differences in level ratings and domain weightings. This methodological decision, ultimately, results in the majority of EUD being composed of differences in anchoring values and this finding is important to acknowledge. Anchoring differences are important to present and explore, though in this preference heterogeneity analysis could be drowning out the heterogeneity in level ratings and domain weighting. An example of this can be shown through the age preference heterogeneity in <a href="#fig-age" class="quarto-xref">Figure&nbsp;4</a>. Preference heterogeneity is evident between individuals above and below age 35 and if we consider the mean PITS values for those two subgroups (age (&lt;) 35 = -0.281; age (&gt;) 34 = 0.487) we can see that a clear difference in anchoring responses is evident.</p>
<p>A methodological exploration was conducted as a sensitivity analysis to limit the influence that anchoring variation has on the overall preference heterogeneity. We considered this to be a strength of the research as it offers a new approach to decompose preference heterogeneity into anchoring variation and the difference in level ratings and domain weightings. After exclusion of individual variation in anchoring responses, weight status and age were found to have a significant impact on preference heterogeneity within our sample; though the amount of variation that could be explained was limited. Preference heterogeneity between those of normal weight and those who were overweight is illustrated in Figure <a href="#fig-weight" class="quarto-xref">Figure&nbsp;5</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-weight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="hesg_paper_files/figure-html/fig-weight-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Social and individual utility functions grouped by weight status
</figcaption>
</figure>
</div>
</div>
</div>
<p>This method of estimating preference heterogeneity should not be considered the gold standard, as only part of the variation in preferences is explored here. It can however be considered an additional option for future researchers that wish to isolate the effect of anchoring responses on overall preference heterogeneity. It is also, to our knowledge, the first time preference heterogeneity has been decomposed in this way with the OPUF.</p>
<p>The value set estimated here offers an alternative choice of preference values to the existing value sets estimated using DCE (shown in Figure <span class="math inline">\(\ref{tab:WAITE val sets}\)</span>). When comparing the anchored coefficients between value sets, one of the key areas of divergence is where levels have been collapsed in the DCE value set. In the OPUF, “I almost never get tired” is given 0.029 compared to 0.064 in the DCE due to collapsing levels. Generally the difference between coefficients that have not been `collapsed’ between the value sets is small suggesting that there is comparability to an extent between the value sets. Anchoring values were broadly similar between studies too. The mean PITS utility values between studies were broadly comparable with a maximum range of 0.059. Interestingly, the EQ-VAS anchoring task mean (0.289) was remarkably similar to the OPUF VAS anchoring task mean (0.282) again supporting the use of VAS for elicitation of PITS utility values.</p>
</section>
<section id="bibliography" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Bibliography</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Anderson2017" class="csl-entry" role="listitem">
Anderson, Marti J. 2017.<span>“<span class="nocase">Permutational Multivariate Analysis of Variance ( PERMANOVA ) </span>.”</span> In <em>Wiley StatsRef: Statistics Reference Online</em>. <a href="https://doi.org/10.1002/9781118445112.stat07841">https://doi.org/10.1002/9781118445112.stat07841</a>.
</div>
<div id="ref-2003ApplyingTechniques" class="csl-entry" role="listitem">
<em><span>Applying Contemporary Statistical Techniques</span></em>. 2003. <a href="https://doi.org/10.1016/b978-0-12-751541-0.x5021-4">https://doi.org/10.1016/b978-0-12-751541-0.x5021-4</a>.
</div>
<div id="ref-BanaECosta1999TheApplication" class="csl-entry" role="listitem">
Bana E Costa, Carlos A., and Jean-Claude Vansnick. 1999. <span>“<span class="nocase">The MACBETH Approach: Basic Ideas, Software, and an Application</span>.”</span> In. <a href="https://doi.org/10.1007/978-94-017-0647-6{\_}9">https://doi.org/10.1007/978-94-017-0647-6{\_}9</a>.
</div>
<div id="ref-Belton2002MultipleAnalysis" class="csl-entry" role="listitem">
Belton, Valerie, and Theodor J. Stewart. 2002. <em><span>Multiple Criteria Decision Analysis</span></em>. Springer US. <a href="https://doi.org/10.1007/978-1-4615-1495-4">https://doi.org/10.1007/978-1-4615-1495-4</a>.
</div>
<div id="ref-Bray2024DevelopmentImpairment" class="csl-entry" role="listitem">
Bray, Nathan, Rhiannon Tudor Edwards, and Paul Schneider. 2024. <span>“<span class="nocase">Development of a value-based scoring system for the MobQoL-7D: a novel tool for measuring quality-adjusted life years in the context of mobility impairment</span>.”</span> <em>Disability and Rehabilitation</em>, 1–10. <a href="https://doi.org/10.1080/09638288.2023.2297929">https://doi.org/10.1080/09638288.2023.2297929</a>.
</div>
<div id="ref-Brodszky2023PCR108States" class="csl-entry" role="listitem">
Brodszky, V., S. Plankó, P. Schneider, and N. Devlin. 2023. <span>“<span class="nocase">PCR108 Pilot Testing the Hungarian Version of Online Elicitation of Personal Utility Functions Tool for Valuing EQ-5D-5L Health States</span>.”</span> <em>Value in Health</em> 26 (12): S469. <a href="https://doi.org/10.1016/j.jval.2023.09.2547">https://doi.org/10.1016/j.jval.2023.09.2547</a>.
</div>
<div id="ref-Danner2011IntegratingPreferences" class="csl-entry" role="listitem">
Danner, Marion, J. Marjan Hummel, Fabian Volz, Jeannette G. Van Manen, Beate Wiegard, Charalabos Markos Dintsios, Hilda Bastian, Andreas Gerber, and Maarten J. Ijzerman. 2011. <span>“<span class="nocase">Integrating patients’ views into health technology assessment: Analytic hierarchy process (AHP) as a method to elicit patient preferences</span>.”</span> <em>International Journal of Technology Assessment in Health Care</em> 27 (4). <a href="https://doi.org/10.1017/S0266462311000523">https://doi.org/10.1017/S0266462311000523</a>.
</div>
<div id="ref-Devlin2019AFunctions" class="csl-entry" role="listitem">
Devlin, Nancy J., Koonal K. Shah, Brendan J. Mulhern, Krystallia Pantiri, and Ben van Hout. 2019. <span>“<span class="nocase">A new method for valuing health: directly eliciting personal utility functions</span>.”</span> <em>European Journal of Health Economics</em> 20 (2). <a href="https://doi.org/10.1007/s10198-018-0993-z">https://doi.org/10.1007/s10198-018-0993-z</a>.
</div>
<div id="ref-Hauber2016StatisticalForce" class="csl-entry" role="listitem">
Hauber, A. Brett, Juan Marcos González, Catharina G. M. Groothuis-Oudshoorn, Thomas Prior, Deborah A. Marshall, Charles Cunningham, Maarten J. IJzerman, and John F. P. Bridges. 2016. <span>“<span class="nocase">Statistical Methods for the Analysis of Discrete Choice Experiments: A Report of the ISPOR Conjoint Analysis Good Research Practices Task Force</span>.”</span> <em>Value in Health</em> 19 (4). <a href="https://doi.org/10.1016/j.jval.2016.04.004">https://doi.org/10.1016/j.jval.2016.04.004</a>.
</div>
<div id="ref-Keeney1979DecisionsTrade-Offs" class="csl-entry" role="listitem">
Keeney, R. L., and H. Raiffa. 1979. <span>“<span class="nocase">Decisions with Multiple Objectives: Preferences and Value Trade-Offs</span>.”</span> <a href="https://doi.org/10.1109/TSMC.1979.4310245">https://doi.org/10.1109/TSMC.1979.4310245</a>.
</div>
<div id="ref-Marsh2016MultipleForce" class="csl-entry" role="listitem">
Marsh, Kevin, Maarten Ijzerman, Praveen Thokala, Rob Baltussen, Meindert Boysen, Zoltán Kaló, Thomas Lönngren, et al. 2016. <span>“<span class="nocase">Multiple Criteria Decision Analysis for Health Care Decision Making - Emerging Good Practices: Report 2 of the ISPOR MCDA Emerging Good Practices Task Force</span>.”</span> <em>Value in Health</em> 19 (2). <a href="https://doi.org/10.1016/j.jval.2015.12.016">https://doi.org/10.1016/j.jval.2015.12.016</a>.
</div>
<div id="ref-Oliveira2018ValuingStates" class="csl-entry" role="listitem">
Oliveira, Mónica Duarte, Andreia Agostinho, Lara Ferreira, Paulo Nicola, and Carlos Bana E Costa. 2018. <span>“<span class="nocase">Valuing health states: Is the MACBETH approach useful for valuing EQ-5D-3L health states?</span>”</span> <em>Health and Quality of Life Outcomes</em> 16 (1). <a href="https://doi.org/10.1186/s12955-018-1056-y">https://doi.org/10.1186/s12955-018-1056-y</a>.
</div>
<div id="ref-Peer2022DataResearch" class="csl-entry" role="listitem">
Peer, Eyal, David Rothschild, Andrew Gordon, Zak Evernden, and Ekaterina Damer. 2022. <span>“<span class="nocase">Data quality of platforms and panels for online behavioral research</span>.”</span> <em>Behavior Research Methods</em> 54 (4). <a href="https://doi.org/10.3758/s13428-021-01694-3">https://doi.org/10.3758/s13428-021-01694-3</a>.
</div>
<div id="ref-Robinson2019EstimatingEvaluation" class="csl-entry" role="listitem">
Robinson, Tomos, and Yemi Oluboyede. 2019. <span>“<span class="nocase">Estimating CHU-9D Utility Scores from the WAItE: A Mapping Algorithm for Economic Evaluation</span>.”</span> <em>Value in Health</em> 22 (2). <a href="https://doi.org/10.1016/j.jval.2018.09.2839">https://doi.org/10.1016/j.jval.2018.09.2839</a>.
</div>
<div id="ref-Schneider2022TheStates" class="csl-entry" role="listitem">
Schneider, P P, B van Hout, M Heisen, J Brazier, and N Devlin. 2022. <span>“<span class="nocase">The Online Elicitation of Personal Utility Functions (OPUF) tool: a new method for valuing health states</span>.”</span> <em>Wellcome Open Res</em> 7: 14. <a href="https://doi.org/10.12688/wellcomeopenres.17518.1">https://doi.org/10.12688/wellcomeopenres.17518.1</a>.
</div>
<div id="ref-Schneider2024ExploringLevel" class="csl-entry" role="listitem">
Schneider, Paul, Nancy Devlin, Ben van Hout, and John Brazier. 2024. <span>“<span class="nocase">Exploring health preference heterogeneity in the UK: Using the online elicitation of personal utility functions approach to construct EQ-5D-5L value functions on societal, group and individual level</span>.”</span> <em>Health Economics (United Kingdom)</em> 33 (5). <a href="https://doi.org/10.1002/hec.4805">https://doi.org/10.1002/hec.4805</a>.
</div>
<div id="ref-Souza2013PopulationEstuary" class="csl-entry" role="listitem">
Souza, Allan T., Ester Dias, Ana Nogueira, Joana Campos, João C. Marques, and Irene Martins. 2013. <span>“<span class="nocase">Population ecology and habitat preferences of juvenile flounder Platichthys flesus (Actinopterygii: Pleuronectidae) in a temperate estuary</span>.”</span> <em>Journal of Sea Research</em> 79. <a href="https://doi.org/10.1016/j.seares.2013.01.005">https://doi.org/10.1016/j.seares.2013.01.005</a>.
</div>
<div id="ref-White2011MultiplePractice" class="csl-entry" role="listitem">
White, Ian R., Patrick Royston, and Angela M. Wood. 2011. <span>“<span class="nocase">Multiple imputation using chained equations: Issues and guidance for practice</span>.”</span> <em>Statistics in Medicine</em> 30 (4). <a href="https://doi.org/10.1002/sim.4067">https://doi.org/10.1002/sim.4067</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>